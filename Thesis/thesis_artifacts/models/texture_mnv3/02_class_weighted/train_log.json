{
  "config": {
    "data_root": "/Users/nikitamasch/Downloads/merged/texture_data_final",
    "out": "/Users/nikitamasch/Downloads/merged/thesisModels/ThesisRUNSFinal/02_class_weighted",
    "device": "mps",
    "epochs": 10,
    "batch_size": 32,
    "lr": 0.001,
    "weight_decay": 0.01,
    "num_workers": 6,
    "seed": 42,
    "aug": false,
    "balanced_sampling": false,
    "class_weighted_loss": true,
    "weight_scheme": "inv",
    "cb_beta": 0.9999
  },
  "classes": [
    "asphalt",
    "cobblestone",
    "gravel",
    "sand"
  ],
  "train_class_counts": [
    245780.0,
    4185.0,
    85083.0,
    84949.0
  ],
  "epochs": [
    {
      "epoch": 1,
      "train_loss": 0.2593247908068654,
      "val": {
        "precision_macro": 0.8196458641386073,
        "recall_macro": 0.9108596103020543,
        "f1_macro": 0.8511753153790875,
        "per_class_precision": [
          0.9607907204705114,
          0.5995397008055235,
          0.8981279930343927,
          0.8201250422440014
        ],
        "per_class_recall": [
          0.9571316971551331,
          0.9961759082217974,
          0.7759285378467324,
          0.9142022979845545
        ],
        "per_class_f1": [
          0.9589577184600584,
          0.7485632183908046,
          0.8325682288251022,
          0.8646120958403848
        ],
        "confusion_matrix": [
          [
            29405,
            347,
            430,
            540
          ],
          [
            2,
            521,
            0,
            0
          ],
          [
            794,
            0,
            8252,
            1589
          ],
          [
            404,
            1,
            506,
            9707
          ]
        ],
        "true_hist": [
          30722,
          523,
          10635,
          10618
        ],
        "pred_hist": [
          30605,
          869,
          9188,
          11836
        ],
        "num_samples": 52498
      },
      "lr": 0.0009755282581475768,
      "time_s": 650.9591660499573
    },
    {
      "epoch": 2,
      "train_loss": 0.20030215589228265,
      "val": {
        "precision_macro": 0.9241881168671527,
        "recall_macro": 0.9372233579407296,
        "f1_macro": 0.9304198594910598,
        "per_class_precision": [
          0.9745859602129814,
          0.9509090909090909,
          0.8910977501939488,
          0.88015966615259
        ],
        "per_class_recall": [
          0.9711281817590001,
          1.0,
          0.864033850493653,
          0.9137313995102656
        ],
        "per_class_f1": [
          0.9728539985326485,
          0.9748369058713886,
          0.8773571394471762,
          0.8966313941130262
        ],
        "confusion_matrix": [
          [
            29835,
            27,
            383,
            477
          ],
          [
            0,
            523,
            0,
            0
          ],
          [
            602,
            0,
            9189,
            844
          ],
          [
            176,
            0,
            740,
            9702
          ]
        ],
        "true_hist": [
          30722,
          523,
          10635,
          10618
        ],
        "pred_hist": [
          30613,
          550,
          10312,
          11023
        ],
        "num_samples": 52498
      },
      "lr": 0.0009045084971874736,
      "time_s": 650.3677380084991
    },
    {
      "epoch": 3,
      "train_loss": 0.1808214290627809,
      "val": {
        "precision_macro": 0.9396281176212429,
        "recall_macro": 0.9518599338146527,
        "f1_macro": 0.9454423673425402,
        "per_class_precision": [
          0.9918237112374115,
          0.9793621013133208,
          0.8706441393875396,
          0.9166825185466997
        ],
        "per_class_recall": [
          0.9713234815441703,
          0.9980879541108987,
          0.9303244005641749,
          0.9077038990393671
        ],
        "per_class_f1": [
          0.9814665592264303,
          0.9886363636363636,
          0.8994954316105277,
          0.9121711148968389
        ],
        "confusion_matrix": [
          [
            29841,
            11,
            600,
            270
          ],
          [
            1,
            522,
            0,
            0
          ],
          [
            135,
            0,
            9894,
            606
          ],
          [
            110,
            0,
            870,
            9638
          ]
        ],
        "true_hist": [
          30722,
          523,
          10635,
          10618
        ],
        "pred_hist": [
          30087,
          533,
          11364,
          10514
        ],
        "num_samples": 52498
      },
      "lr": 0.0007938926261462366,
      "time_s": 650.7680530548096
    },
    {
      "epoch": 4,
      "train_loss": 0.16209898981914966,
      "val": {
        "precision_macro": 0.9452901789236243,
        "recall_macro": 0.9523075746717737,
        "f1_macro": 0.9486313381670634,
        "per_class_precision": [
          0.9904787093361545,
          0.9961904761904762,
          0.9031463229719484,
          0.8913452071959187
        ],
        "per_class_recall": [
          0.97519692728338,
          1.0,
          0.8960977903149977,
          0.9379355810887172
        ],
        "per_class_f1": [
          0.9827784156142365,
          0.9980916030534351,
          0.8996082503421909,
          0.914047083658391
        ],
        "confusion_matrix": [
          [
            29960,
            2,
            507,
            253
          ],
          [
            0,
            523,
            0,
            0
          ],
          [
            144,
            0,
            9530,
            961
          ],
          [
            144,
            0,
            515,
            9959
          ]
        ],
        "true_hist": [
          30722,
          523,
          10635,
          10618
        ],
        "pred_hist": [
          30248,
          525,
          10552,
          11173
        ],
        "num_samples": 52498
      },
      "lr": 0.0006545084971874737,
      "time_s": 651.5467109680176
    },
    {
      "epoch": 5,
      "train_loss": 0.1435606414827946,
      "val": {
        "precision_macro": 0.9435318125364238,
        "recall_macro": 0.9510440900832824,
        "f1_macro": 0.9468454828448066,
        "per_class_precision": [
          0.9914292332638406,
          0.9942965779467681,
          0.9077537502435223,
          0.8806476886915644
        ],
        "per_class_recall": [
          0.97519692728338,
          1.0,
          0.8762576398683591,
          0.95272179318139
        ],
        "per_class_f1": [
          0.983246090480957,
          0.9971401334604385,
          0.8917276685326061,
          0.915268038905225
        ],
        "confusion_matrix": [
          [
            29960,
            3,
            564,
            195
          ],
          [
            0,
            523,
            0,
            0
          ],
          [
            140,
            0,
            9319,
            1176
          ],
          [
            119,
            0,
            383,
            10116
          ]
        ],
        "true_hist": [
          30722,
          523,
          10635,
          10618
        ],
        "pred_hist": [
          30219,
          526,
          10266,
          11487
        ],
        "num_samples": 52498
      },
      "lr": 0.0005,
      "time_s": 652.2833261489868
    },
    {
      "epoch": 6,
      "train_loss": 0.1253321252619739,
      "val": {
        "precision_macro": 0.9347960508109885,
        "recall_macro": 0.9499562235572203,
        "f1_macro": 0.9412501267626712,
        "per_class_precision": [
          0.9915285451197053,
          0.9757462686567164,
          0.920778318276581,
          0.8511310711909514
        ],
        "per_class_recall": [
          0.9638695397435063,
          1.0,
          0.8721203573107663,
          0.9638349971746092
        ],
        "per_class_f1": [
          0.9775034248271082,
          0.987724268177526,
          0.8957890670272358,
          0.9039837470188146
        ],
        "confusion_matrix": [
          [
            29612,
            13,
            447,
            650
          ],
          [
            0,
            523,
            0,
            0
          ],
          [
            220,
            0,
            9275,
            1140
          ],
          [
            33,
            0,
            351,
            10234
          ]
        ],
        "true_hist": [
          30722,
          523,
          10635,
          10618
        ],
        "pred_hist": [
          29865,
          536,
          10073,
          12024
        ],
        "num_samples": 52498
      },
      "lr": 0.00034549150281252633,
      "time_s": 652.8276300430298
    },
    {
      "epoch": 7,
      "train_loss": 0.1090804747217745,
      "val": {
        "precision_macro": 0.955934180288653,
        "recall_macro": 0.9608361439369926,
        "f1_macro": 0.9583443363754247,
        "per_class_precision": [
          0.9903331156107119,
          0.9849340866290018,
          0.9129672358098754,
          0.9355022831050228
        ],
        "per_class_recall": [
          0.9870451142503743,
          1.0,
          0.9301363422661025,
          0.9261631192314936
        ],
        "per_class_f1": [
          0.9886863812722115,
          0.9924098671726755,
          0.9214718211457849,
          0.930809275911027
        ],
        "confusion_matrix": [
          [
            30324,
            8,
            274,
            116
          ],
          [
            0,
            523,
            0,
            0
          ],
          [
            181,
            0,
            9892,
            562
          ],
          [
            115,
            0,
            669,
            9834
          ]
        ],
        "true_hist": [
          30722,
          523,
          10635,
          10618
        ],
        "pred_hist": [
          30620,
          531,
          10835,
          10512
        ],
        "num_samples": 52498
      },
      "lr": 0.0002061073738537635,
      "time_s": 652.9816770553589
    },
    {
      "epoch": 8,
      "train_loss": 0.09262666142560383,
      "val": {
        "precision_macro": 0.9591200524489254,
        "recall_macro": 0.9629049697391563,
        "f1_macro": 0.9608825684041926,
        "per_class_precision": [
          0.9923528832583938,
          0.9980916030534351,
          0.9315436241610738,
          0.9144920993227991
        ],
        "per_class_recall": [
          0.9841807174012108,
          1.0,
          0.9135872120357311,
          0.9538519495196836
        ],
        "per_class_f1": [
          0.9882499060319327,
          0.9990448901623686,
          0.9224780441490624,
          0.9337574332734062
        ],
        "confusion_matrix": [
          [
            30236,
            1,
            269,
            216
          ],
          [
            0,
            523,
            0,
            0
          ],
          [
            188,
            0,
            9716,
            731
          ],
          [
            45,
            0,
            445,
            10128
          ]
        ],
        "true_hist": [
          30722,
          523,
          10635,
          10618
        ],
        "pred_hist": [
          30469,
          524,
          10430,
          11075
        ],
        "num_samples": 52498
      },
      "lr": 9.549150281252634e-05,
      "time_s": 653.1357016563416
    },
    {
      "epoch": 9,
      "train_loss": 0.07799877553712904,
      "val": {
        "precision_macro": 0.963383216851653,
        "recall_macro": 0.9649630503453388,
        "f1_macro": 0.9641706469350462,
        "per_class_precision": [
          0.9921347214516497,
          0.9980916030534351,
          0.9271243669105234,
          0.9361821759910036
        ],
        "per_class_recall": [
          0.9895189115291974,
          1.0,
          0.9294781382228491,
          0.9408551516293088
        ],
        "per_class_f1": [
          0.9908250900379708,
          0.9990448901623686,
          0.928299760529652,
          0.9385128470101931
        ],
        "confusion_matrix": [
          [
            30400,
            1,
            221,
            100
          ],
          [
            0,
            523,
            0,
            0
          ],
          [
            169,
            0,
            9885,
            581
          ],
          [
            72,
            0,
            556,
            9990
          ]
        ],
        "true_hist": [
          30722,
          523,
          10635,
          10618
        ],
        "pred_hist": [
          30641,
          524,
          10662,
          10671
        ],
        "num_samples": 52498
      },
      "lr": 2.4471741852423235e-05,
      "time_s": 653.4020938873291
    },
    {
      "epoch": 10,
      "train_loss": 0.06897858812450088,
      "val": {
        "precision_macro": 0.9638301969808535,
        "recall_macro": 0.9655078675171791,
        "f1_macro": 0.9646653895784953,
        "per_class_precision": [
          0.9928834916593217,
          0.9980916030534351,
          0.925669997198618,
          0.9386756960120392
        ],
        "per_class_recall": [
          0.9900071609921229,
          1.0,
          0.9321109543958627,
          0.9399133546807308
        ],
        "per_class_f1": [
          0.9914432401597262,
          0.9990448901623686,
          0.9288793103448276,
          0.9392941176470588
        ],
        "confusion_matrix": [
          [
            30415,
            1,
            235,
            71
          ],
          [
            0,
            523,
            0,
            0
          ],
          [
            141,
            0,
            9913,
            581
          ],
          [
            77,
            0,
            561,
            9980
          ]
        ],
        "true_hist": [
          30722,
          523,
          10635,
          10618
        ],
        "pred_hist": [
          30633,
          524,
          10709,
          10632
        ],
        "num_samples": 52498
      },
      "lr": 0.0,
      "time_s": 653.2795948982239
    }
  ],
  "train_class_weights": [
    0.06105867028236389,
    3.585901975631714,
    0.1763806939125061,
    0.17665892839431763
  ],
  "best_val_f1": 0.9646653895784953,
  "test": {
    "precision_macro": 0.962205400335429,
    "recall_macro": 0.9648386783720391,
    "f1_macro": 0.9635126180530411,
    "per_class_precision": [
      0.9942090626533617,
      0.9980952380952381,
      0.9245318352059925,
      0.9319854653871238
    ],
    "per_class_recall": [
      0.9890961169156658,
      1.0,
      0.928356525009402,
      0.9419020715630885
    ],
    "per_class_f1": [
      0.9916459992168124,
      0.9990467111534795,
      0.9264402326890598,
      0.9369175291528122
    ],
    "confusion_matrix": [
      [
        30388,
        1,
        250,
        84
      ],
      [
        0,
        524,
        0,
        0
      ],
      [
        116,
        0,
        9874,
        646
      ],
      [
        61,
        0,
        556,
        10003
      ]
    ],
    "true_hist": [
      30723,
      524,
      10636,
      10620
    ],
    "pred_hist": [
      30565,
      525,
      10680,
      10733
    ],
    "num_samples": 52503
  },
  "training_duration_seconds": 6639,
  "training_duration_source": "training_session_20260212_214335.log"
}